# Schema de validation pour les fiches (défaut: RWEB, REIPRO, RIA)
# environmental_impact et priority_implementation sont des numbers (use-5-grades)
# scope n'est pas requis, moe/tiers/rgesnField sont activés
allOf:
  - $ref: ./common.schema.yaml
  - properties:
      refID:
        type: string
      refType:
        type: string
        description: Inutile
      versions:
        type: array
        minItems: 1
        properties:
          version:
            type: string
          idRef:
            type: string
      people:
        type: string
        description: Inutile
      responsible:
        type: array
        minItems: 1
        items:
          type: object
          required:
            - responsible
          properties:
            responsible:
              type: string
              minLength: 1
              pattern: '^src/content/personas/'
              description: 'Référence vers un persona (format: src/content/personas/{lang}/{nom-persona}.mdx)'
      lifecycle:
        type: string
      environmental_impact:
        type: number
      priority_implementation:
        type: number
      moe:
        type: number
      tiers:
        type: array
        minItems: 1
      scope:
        type: array
      saved_resources:
        type: array
        minItems: 1
      rgesn:
        type: string
      validations:
        type: array
        minItems: 1
        properties:
          rule:
            type: string
            minLength: 1
          maxValue:
            type: string
            minLength: 1

  - required:
      - refID
      - versions
      - responsible
      - lifecycle
      - environmental_impact
      - priority_implementation
      - saved_resources
      - validations
